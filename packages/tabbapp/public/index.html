<!doctype html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="user-scalable=0, initial-scale=1, minimum-scale=1, width=device-width, height=device-height">

    <title>TABB</title>

    <!-- Application primary color -->
    <meta name="theme-color" content="#C13131">

    <!-- Application manifest -->
    <link rel="manifest" href="/manifest.json">

    <!-- Fulscreen webapp on iOS < 11.3 that don't support manifest spec -->
    <meta name="apple-mobile-web-app-capable" content="yes" />

    <!-- Set status bar content for a more native feel -->
    <meta name="apple-mobile-web-app-status-bar-style" content="white">

    <!-- Application splash image on iOs devices -->
    <link href="/apple-splash-2048x2732.png" sizes="2048x2732" rel="apple-touch-startup-image" />
    <link href="/apple-splash-1668x2224.png" sizes="1668x2224" rel="apple-touch-startup-image" />
    <link href="/apple-splash-1536x2048.png" sizes="1536x2048" rel="apple-touch-startup-image" />
    <link href="/apple-splash-1125x2436.png" sizes="1125x2436" rel="apple-touch-startup-image" />
    <link href="/apple-splash-1242x2208.png" sizes="1242x2208" rel="apple-touch-startup-image" />
    <link href="/apple-splash-750x1334.png" sizes="750x1334" rel="apple-touch-startup-image" />

    <!-- When adding to home screen on iOS devices -->
    <meta name="apple-mobile-web-app-title" content="TABB">

    <!-- iPhone(first generation or 2G), iPhone 3G, iPhone 3GS -->
    <link rel="apple-touch-icon" sizes="57x57" href="touch-icon-57x57.png">
    <!-- iPad and iPad mini @1x -->
    <link rel="apple-touch-icon" sizes="76x76" href="touch-icon-76x76.png">
    <!-- iPhone 4, iPhone 4s, iPhone 5, iPhone 5c, iPhone 5s, iPhone 6, iPhone 6s, iPhone 7, iPhone 7s, iPhone8 -->
    <link rel="apple-touch-icon" sizes="120x120" href="touch-icon-120x120.png">
    <!-- iPad and iPad mini @2x -->
    <link rel="apple-touch-icon" sizes="152x152" href="touch-icon-152x152.png">
    <!-- iPad Pro -->
    <link rel="apple-touch-icon" sizes="167x167" href="touch-icon-167x167.png">
    <!-- iPhone X, iPhone 8 Plus, iPhone 7 Plus, iPhone 6s Plus, iPhone 6 Plus -->
    <link rel="apple-touch-icon" sizes="180x180" href="touch-icon-180x180.png">

    <!-- Android Devices High Resolution -->
    <link rel="icon" sizes="192x192" href="android-icon-192x192.png">
    <!-- Android Devices Normal Resolution -->
    <link rel="icon" sizes="128x128" href="android-icon-128x128.png">
    <!-- Other android resolutions -->
    <link rel="icon" sizes="256x256" href="android-icon-256x256.png">
    <link rel="icon" sizes="512x512" href="android-icon-512x512.png">

    <!-- Browser icons -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/png" sizes="64x64" href="/favicon-64x64.png">
    <link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="24x24" href="/favicon-24x24.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">

    <!-- Safari pinned tab and MacBook Touchbar icons-->
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#c13939">

    <!-- Windows 8 / 10 and Windows Phone -->
    <meta name="msapplication-TileColor" content="#c13939">

    <!-- Fonts and stylesheets -->

    <link href="https://fonts.googleapis.com/css?family=Lato:300,400" rel="stylesheet">
    <!--<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,500" -->
    <!--link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" /-->
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.42.0/mapbox-gl.css' rel='stylesheet' />
    <style>
      a.mapboxgl-ctrl-logo {
        display: none;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script src=https://cdn.ravenjs.com/3.24.0/raven.min.js crossorigin=anonymous></script>
    <script>
     Raven.config('https://b34f069a5b2d40f2ac5b07a96353591e@sentry.io/1227775', {
       release: '0-0-0',
       environment: 'development-test',
     }).install()
    </script>
    <script src="https://www.gstatic.com/firebasejs/5.2.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.2.0/firebase-messaging.js"></script>
    <script>
      // Initialize Firebase
      const config = {
        apiKey: "AIzaSyAwKYz-JN76QWYpK60TEL1YJhV_cIh9ciM",
        authDomain: "tabb-global.firebaseapp.com",
        databaseURL: "https://tabb-global.firebaseio.com",
        projectId: "tabb-global",
        storageBucket: "tabb-global.appspot.com",
        messagingSenderId: "448538111630"
      };
      firebase.initializeApp(config);
      const messaging = firebase.messaging();

      const getToken = overwrite => {
        messaging.getToken().then(currentToken => {
          if (currentToken) {
            //TODO: store the token in the database
            console.log(overwrite, currentToken);

          } else {
            console.log('No Instance ID token available. Request permission to generate one.');
          }
        })
        .catch(err => {
          console.log('Unable to retrieve token', err);
        });
      };

      messaging.usePublicVapidKey("BITD-4Cv-rGg9cYTpcix1Q9a8WVEph6fmSDets8TImuVMtKNaXuMWvgm70jXOCwAbopwk-cnPLteitUVBA1M-MY");
      messaging.requestPermission().then(() => {
        console.log('Notification permission granted.');
        getToken(false);
      }).catch(err => {
        console.log('Unable to get permission to notify.', err);
      });

      // Callback fired if Instance ID token is updated.
      messaging.onTokenRefresh(() => {
        getToken(true);
      });

      messaging.onMessage(payload => {
        console.log('Received message ', payload);
      });

    </script>
    <script>
        if ('serviceWorker' in navigator) {
          navigator.serviceWorker.register('./firebase-messaging-sw.js')
          .then(registration => {
            console.log('Registration successful, scope is:', registration.scope);
          }).catch(err => {
            console.log('Service worker registration failed, error:', err);
          });
        }
    </script>
  </body>
</html>
